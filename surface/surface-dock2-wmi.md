---
title: 使用 WMI 管理 Surface Dock 2
description: 本文介绍如何使用 WMI 在 Surface Dock 2 设备上远程监视和管理最新的固件、策略状态和相关数据。
ms.prod: w10
ms.mktglfcycl: manage
ms.localizationpriority: medium
ms.sitesec: library
author: coveminer
ms.author: greglin
ms.topic: article
ms.date: 10/12/2020
ms.reviewer: hachidan
manager: laurawi
audience: itpro
ms.openlocfilehash: 06933d49e99862fb19d0f6a09c9680a127b755cd
ms.sourcegitcommit: c1efb75e8524193bdc0a5f7496dc23a92ac665c8
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/12/2020
ms.locfileid: "11114650"
---
# 使用 WMI 管理 Surface Dock 2

Windows Management Instrumentation (WMI) 支持提供一组丰富的诊断信息，使 IT 管理员可以在 Surface Dock 2 设备上远程监视和管理最新的固件、策略状态和相关数据。 你可以将 WMI 与 Windows PowerShell、System Center Operations Manager 和其他工具配合使用。 有关 WMI 的详细信息，请参阅使用 [wmi](https://docs.microsoft.com/powershell/scripting/learn/ps101/07-working-with-wmi?&preserve-view=true)。 

若要启用 WMI 支持，请转到 [Surface Dock 2 驱动程序和固件](https://www.microsoft.com/download/details.aspx?id=101317) 并下载相应的程序包：

**SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;版本 # C1_x64.msi：**<br>

- Surface Pro (5 代和更高版本) 
- Surface Book (第二代和更高版本) 
- Surface Go (所有代) 
- Surface 膝上型电脑 (所有产品) 
- Surface 膝上型电脑 Go

 **SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;版本 # C1_arm64.msi：** <br>

- Surface Pro X

## 将 WMI 与 Surface Dock 配合使用2

1. 要枚举所有 dock 组件实例，请执行以下操作：

    ```PowerShell
    Get-CimInstance -Namespace "root/Surface" -Class "SurfaceDockComponent" 
    ```
2. 若要访问 WMI 类属性说明，请打开命令提示符并输入 WMI 命令，其中 **属性** 是表1中列出的属性之一。

    ```PowerShell
     Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["<Property>"]
    ```

- **示例：** 若要访问 **版本** 通用信息模型 (CIM) 属性的说明，请输入以下内容：
    ```PowerShell
    (Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["Version"].Qualifiers["Description"].Value
    ```
 
 ### 表 1.  Surface Dock 2 WMI 参考

| 属性         | 类型   | 预期值 (s)                                                                                                                                                                                                             | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ---------------- | ------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ComponentName    | 字符串 | 微控制器 <br>"USB 集线器 1" <br>"USB 集线器 2" <br>"显示端口集线器" <br>"Power 交运控制器" <br>"音频编解码器" <br>"以太网控制器"                                                                         | 以下属性列出了随附的通用信息模型 (CIM) 类数据对应的设备组件的特定名称。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| DeviceName       | 字符串 | "Surface Dock 1" <br>"Surface Dock 2"                                                                                                                                                                                        | 以下属性包含特定设备组件所属的停靠设备的名称。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| DockSerialNumber | 字符串 | 12 (12) 数字序列号（仅包含数字值）                                                                                                                                                           | 以下属性记录连接的 dock 设备的序列号。 对于每个组件，此序列号对于属于同一台停靠设备而言是完全相同的。 对于引用，此序列号可以物理地位于 Surface Dock 本身的底部。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ID               | uint16 | 0、1、2、...、65535                                                                                                                                                                                                          | 以下属性是从零开始 (0) 和计数的唯一 Id。 此变量用于对枚举的 WMI 实例进行编号。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| LastUpdateStatus | 字符串 | 辉煌 <br>"PendingDockReattach" <br>未                                                                                                                                                                             | 以下属性详细介绍了上次尝试的组件固件更新 (CFU 设备组件) 状态。 可能的值包括：**成功、挂起的****停靠重新连接**和**失败。**<br><br><br>- **成功** 表示以前应用的新固件已成功应用<br>- **挂起的停靠重新附加** 指示设备组件有一个挂起的新更新，并且用户必须分离并重新连接坞站 Surface connector 才能应用新的更新。<br>- "**失败**" 表示在 CFU 过程中可能出现合法错误，或者外围设备未在预期版本中启动。 在 **失败** 的情况下，这并不表示设备无法正常工作，而是在尝试更新设备时发生错误。 在这种情况下，以前的固件将继续运行。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| PolicyState      | 字符串 | 处于 <br>禁用                                                                                                                                                                                                     | 以下属性指示设备组件的当前 Surface 企业管理模式 (SEMM) 策略。 可能的值包括： **启用** 和 **禁用。**<br><br><br>- "**已启用**" 指示 SEMM 系统允许主机设备访问和使用设备组件<br>- "**已禁用**" 表示 SEMM 系统已禁用，因此阻止主机访问和使用设备组件。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProductId        | String[] | 十六进制字符串列表，每个范围从 "0x0000" 到 "0xFFFF"                                                                                                                                                        | 以下属性对设备组件的产品 Id (PID) 进行分类。 可以列出多个 PID。 例如，在 USB 集线器的情况下， (SS) 和高速 (HS) 设备都将被 lumped 为一个单一的 "集线器"。 因此，此数组中将列出两个 (2) Pid。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProvisionedState         | 布尔型 | True 或 False                                                                                                                                                        | 以下属性介绍 (SEMM 的 Surface Enterprise 管理模式，) Surface Dock 设备的预配状态。 预配状态对于属于同一台停靠设备的每个组件而言完全相同。 可能的值为： True 或 False。 True 值表示 Surface Dock 设备当前已被管理，因此端口功能可能受到限制。 有关详细信息，请参阅 "PolicyState" 属性字段。 如果值为 false，则表示 Surface Dock 设备当前不是托管设备，并且未强加任何功能限制。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| 状态           | 字符串 | 正常 <br>断开连接 <br>时发生 <br>缺少 <br>"DeviceHandleInUse" <br>禁用 <br>"NotSupportedByWmi"                                                                                                             | 以下属性描述了停靠与主机的连接的状态。 可能的值包括： **正常、** **断开连接、** **错误、** **缺失、** **DeviceHandleInUse、**  **Disabled** 和 **NotSupportedByWmi。** <br>- **"确定"** 表示设备已成功连接到主机，并且不存在问题，这将导致其功能不正常 <br>- "已**断开**" 指示提供所有设备组件的连接的 Surface connector 当前未连接到主机。 <br>- **错误** 表示设备实例和设备接口的潜在问题在设备管理器中具有黄色惊叹号标记的情况更好，请检查 **StatusCode** 属性以了解有关所发生的错误类型的详细信息。 <br>- **缺少** 表示设备需要在主机上进行枚举，但由于某种原因而不是。 **StatusCode**属性将保留值24以指示此错误情况。<br>- **DeviceHandleInUse** 表示另一个进程当前正在与设备通信，这将阻止此 Windows Management INSTRUMENTATION (WMI) 实例提供商的通信请求。 请再次尝试执行 WMI 命令！ <br> - "**已禁用**" 表示当前 Surface 企业管理模式 (SEMM) 策略不允许，从而阻止主机访问和使用设备组件。 有关详细信息，请参阅 **PolicyState** 属性字段。<br>- **NotSupportedByWmi** 表示此 WMI 提供程序当前不支持已连接的 dock。 此状态将针对 Surface Dock 1 显示，当前不受此 WMI 实例提供程序支持。|
| StatusCode       | uint32 | 从*cimwin32*内的 CIM_LogicalDevice WMI 类 (中获取的[设备管理器错误代码](https://docs.microsoft.com/windows-hardware/drivers/install/device-manager-error-messages))  | 以下属性提供了给定 dock 组件的设备管理器错误代码。 值 0 (0) 表示 dock 组件正常工作;大于零的值 (0) 指示停靠组件存在问题或可能存在的错误。 由于 dock 组件可以用多个设备接口进行枚举，因此可能存在其他设备管理器错误代码。 此属性字段仅列出单个错误代码（即使有多个错误代码）。 仅当发生某些错误代码时，设备管理器才会使用黄色惊叹号对设备进行标记。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| VendorId         | 字符串 | 一个十六进制字符串，范围从 "0x0000" 到 "0xFFFF"                                                                                                                                                                        | 以下属性说明设备组件的特定供应商 Id (VID) 。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| 版本          | 字符串 | 版本字符串，其形式如下所示： "x.x.x.x"，其中 x、y 和 z 是数值。                                                                                                                            | 以下属性指定当前在设备组件上运行的固件的当前版本。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |


## 了解详细信息

- [使用 SEMM 保护 Surface Dock 2 端口](secure-surface-dock-ports-semm.md)
- [Surface Dock 2 的新增功能](surface-dock-whats-new.md)
- [设备管理器错误代码](https://docs.microsoft.com/windows-hardware/drivers/install/device-manager-error-messages)
- [使用 WMI](https://docs.microsoft.com/powershell/scripting/learn/ps101/07-working-with-wmi?&preserve-view=true)
